<Prefab>
  <!-- Camp Reports Panel - Diplomacy pattern:
       - Toggle header expands a list of CLICKABLE buttons (categories)
       - Clicking a category shows its feed on the right (and auto-selects first entry) -->
  <Constants>
    <Constant Name="ReportsToggle.Width" BrushLayer="Default" BrushName="Kingdom.Policy.Toggle.Tuple" BrushValueType="Width" />
    <Constant Name="ReportsToggle.Height" BrushLayer="Default" BrushName="Kingdom.Policy.Toggle.Tuple" BrushValueType="Height" />
    <Constant Name="Party.Toggle.ExpandIndicator.Width" BrushLayer="Default" BrushName="Party.Toggle.ExpandIndicator" BrushValueType="Width" />
    <Constant Name="Party.Toggle.ExpandIndicator.Height" BrushLayer="Default" BrushName="Party.Toggle.ExpandIndicator" BrushValueType="Height" />
    <Constant Name="Kingdom.Header.Policies.Width" BrushLayer="Default" BrushName="Kingdom.Header.Policies" BrushValueType="Width" />
    <Constant Name="Kingdom.Header.Policies.Height" BrushLayer="Default" BrushName="Kingdom.Header.Policies" BrushValueType="Height" />
    <Constant Name="Kingdom.Scroll.Header.Width" BrushLayer="Default" BrushName="Scroll.Header" BrushValueType="Width" />
    <Constant Name="Kingdom.Scroll.Header.Height" BrushLayer="Default" BrushName="Scroll.Header" BrushValueType="Height" />
  </Constants>
  <Window>
    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" IsVisible="@Show">
      <Children>
        <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent">
          <Children>

            <!-- Left Panel -->
            <BrushListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" VerticalAlignment="Bottom" MarginLeft="0" MarginTop="6" MarginBottom="9" Brush="Frame1Brush" StackLayout.LayoutMethod="VerticalBottomToTop">
              <Children>

                <!-- Header Horizontal Section -->
                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" RenderLate="true">
                  <Children>
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Kingdom.Header.Policies.Width" SuggestedHeight="!Kingdom.Header.Policies.Height" Sprite="SPKingdom\header_policies" ExtendTop="21" ExtendRight="13" ExtendBottom="20" RenderLate="true">
                      <Children>
                        <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="Kingdom.PoliciesCollapserTitle.Text" MarginBottom="8" IsDisabled="true" Text="Camp Reports" />
                      </Children>
                    </Widget>
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Kingdom.Scroll.Header.Width" SuggestedHeight="!Kingdom.Scroll.Header.Height" HorizontalAlignment="Right" Sprite="StdAssets\scroll_header" ExtendRight="3" ExtendTop="6" ExtendLeft="3" ExtendBottom="4" />
                  </Children>
                </ListPanel>

                <!-- List and Scrollbar Horizontal Section -->
                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent">
                  <Children>
                    <ScrollablePanel WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" MarginLeft="3" MarginBottom="3" AutoHideScrollBars="true" ClipRect="ReportsListClipRect" InnerPanel="ReportsListClipRect\ReportsList" VerticalScrollbar="..\ReportsListScrollbar\Scrollbar">
                      <Children>
                        <NavigationScopeTargeter ScopeID="CampReportsCategoriesScope" ScopeParent="..\ReportsListClipRect" ScopeMovements="Vertical" DoNotAutoNavigateAfterSort="true" />
                        <Widget Id="ReportsListClipRect" WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" ClipContents="true">
                          <Children>
                            <NavigatableListPanel Id="ReportsList" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop" MinIndex="0" StepSize="1000">
                              <Children>

                                <!-- Reports Header -->
                                <NavigationAutoScrollWidget TrackedWidget="..\ReportsHeader" />
                                <ScrollablePanelFixedHeaderWidget Id="ReportsHeader" FixedHeader="..\..\..\ReportsToggleButton" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!ReportsToggle.Width" HeaderHeight="!ReportsToggle.Height" />

                                <Widget Id="ReportsParentWidget" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren">
                                  <Children>
                                    <NavigationTargetSwitcher FromTarget="..\." ToTarget="..\ReportsCategoryList" />
                                    <NavigatableListPanel Id="ReportsCategoryList" DataSource="{ReportCategories}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop" UseSelfIndexForMinimum="true">
                                      <ItemTemplate>
                                        <ReportCategoryTuple IsSelected="@IsSelected" />
                                      </ItemTemplate>
                                    </NavigatableListPanel>
                                  </Children>
                                </Widget>

                              </Children>
                            </NavigatableListPanel>
                          </Children>
                        </Widget>

                        <!-- Reports Toggle Button -->
                        <PartyHeaderToggleWidget Id="ReportsToggleButton" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!ReportsToggle.Width" SuggestedHeight="!ReportsToggle.Height" HorizontalAlignment="Left" VerticalAlignment="Top" Brush="Kingdom.Policy.Toggle.Tuple" CollapseIndicator="Description\CollapseIndicator" ListPanel="..\ReportsListClipRect\ReportsList\ReportsParentWidget\ReportsCategoryList" RenderLate="true" WidgetToClose="..\ReportsListClipRect\ReportsList\ReportsParentWidget">
                          <Children>
                            <ListPanel Id="Description" WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" IsDisabled="true" StackLayout.LayoutMethod="HorizontalLeftToRight">
                              <Children>
                                <BrushWidget Id="CollapseIndicator" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Party.Toggle.ExpandIndicator.Width" SuggestedHeight="!Party.Toggle.ExpandIndicator.Height" VerticalAlignment="Center" MarginRight="5" Brush="Party.Toggle.ExpandIndicator" />
                                <RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" MarginRight="5" Brush="Party.Text.Toggle" Text="@ReportsText" />
                                <RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" VerticalAlignment="Center" MarginLeft="5" Brush="Party.Text.Toggle" Text="@NumReportsText" />
                              </Children>
                            </ListPanel>
                          </Children>
                        </PartyHeaderToggleWidget>
                      </Children>
                    </ScrollablePanel>

                    <Standard.VerticalScrollbar Id="ReportsListScrollbar" HeightSizePolicy="StretchToParent" HorizontalAlignment="Right" MarginLeft="2" MarginRight="2" MarginBottom="3" />
                  </Children>
                </ListPanel>

              </Children>
            </BrushListPanel>

            <!-- Right Side -->
            <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent">
              <Children>

                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="540" SuggestedHeight="923" HorizontalAlignment="Right" VerticalAlignment="Bottom" PositionYOffset="80" Sprite="SPGeneral\background_illustration_diplomacy" AlphaFactor="0.7"/>

                <!-- Category Content -->
                <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" MarginLeft="15" IsVisible="@IsCategorySelected" StackLayout.LayoutMethod="VerticalTopToBottom">
                  <Children>

                    <!-- Category Title -->
                    <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginTop="40" MarginLeft="30" MarginRight="80" Brush="Kingdom.TitleMedium.Text" Brush.FontSize="28" Text="@SelectedCategoryTitle" />

                    <!-- Divider -->
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="700" SuggestedHeight="2" HorizontalAlignment="Center" MarginTop="15" Sprite="BlankWhiteSquare_9" Color="#5C4A3AFF" />

                    <!-- Feed + Details -->
                    <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginTop="20" MarginLeft="30" MarginRight="80" StackLayout.LayoutMethod="HorizontalLeftToRight">
                      <Children>

                        <!-- Feed list (clickable entries) -->
                        <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="520">
                          <Children>
                            <ScrollablePanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" AutoHideScrollBars="true" ClipRect="FeedClipRect" InnerPanel="FeedClipRect\FeedList" VerticalScrollbar="..\FeedListScrollbar\Scrollbar">
                              <Children>
                                <NavigationScopeTargeter ScopeID="CampReportsFeedScope" ScopeParent="..\FeedClipRect" ScopeMovements="Vertical" DoNotAutoNavigateAfterSort="true" />
                                <Widget Id="FeedClipRect" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" ClipContents="true">
                                  <Children>
                                    <NavigatableListPanel Id="FeedList" DataSource="{SelectedCategoryNews}" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop" MinIndex="0" StepSize="1000">
                                      <ItemTemplate>
                                        <ReportTuple IsSelected="@IsSelected" />
                                      </ItemTemplate>
                                    </NavigatableListPanel>
                                  </Children>
                                </Widget>
                              </Children>
                            </ScrollablePanel>
                            <Standard.VerticalScrollbar Id="FeedListScrollbar" HeightSizePolicy="StretchToParent" HorizontalAlignment="Right" MarginLeft="2" MarginRight="2" />
                          </Children>
                        </Widget>

                        <!-- Details -->
                        <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="20">
                          <Children>
                            <ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" IsVisible="@IsReportSelected" StackLayout.LayoutMethod="VerticalTopToBottom">
                              <Children>
                                <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" Brush="Kingdom.TitleMedium.Text" Brush.FontSize="24" Text="@SelectedReportTitle" />
                                <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" MarginTop="5" Brush="Kingdom.ParagraphSmall.Text" Brush.FontSize="16" Text="@SelectedReportCategory" />
                                <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="2" HorizontalAlignment="Center" MarginTop="15" Sprite="BlankWhiteSquare_9" Color="#5C4A3AFF" />

                                <ScrollablePanel WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginTop="15" AutoHideScrollBars="true" ClipRect="DescClipRect" InnerPanel="DescClipRect\DescPanel" VerticalScrollbar="..\DescScrollbar\Scrollbar">
                                  <Children>
                                    <Widget Id="DescClipRect" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" ClipContents="true">
                                      <Children>
                                        <RichTextWidget Id="DescPanel" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" Brush="Kingdom.CurrentArmyValues.Text" Text="@SelectedReportDescription" />
                                      </Children>
                                    </Widget>
                                    <Standard.VerticalScrollbar Id="DescScrollbar" HeightSizePolicy="StretchToParent" HorizontalAlignment="Right" MarginLeft="2" MarginRight="2" />
                                  </Children>
                                </ScrollablePanel>
                              </Children>
                            </ListPanel>

                            <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" VerticalAlignment="Center" HorizontalAlignment="Center" Brush="Kingdom.ParagraphSmall.Text" Brush.FontSize="22" IsHidden="@IsReportSelected" Text="Select an entry to view details" />
                          </Children>
                        </Widget>

                      </Children>
                    </ListPanel>
                  </Children>
                </ListPanel>

                <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" VerticalAlignment="Center" HorizontalAlignment="Center" MarginLeft="25" MarginRight="25" Brush="Kingdom.TitleMedium.Text" Brush.FontSize="32" IsHidden="@IsCategorySelected" Text="Select a report type" />
              </Children>
            </Widget>

          </Children>
        </ListPanel>
      </Children>
    </Widget>
  </Window>
</Prefab>
