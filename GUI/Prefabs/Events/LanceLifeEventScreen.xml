<Prefab>
	<Constants>
		<Constant Name="Encyclopedia.Frame.Width" BrushLayer="Default" BrushName="Encyclopedia.Frame" BrushValueType="Width" />
		<Constant Name="Encyclopedia.Frame.Height" BrushLayer="Default" BrushName="Encyclopedia.Frame" BrushValueType="Height" />
	</Constants>
	<Window>
		<!-- Full screen semi-transparent overlay with blur effect -->
		<Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Sprite="BlankWhiteSquare_9" Color="#000000B3">
			<Children>

				<!-- Main event card - centered, modern design -->
				<BrushWidget Id="EventCard" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="1040" SuggestedHeight="720" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="Encyclopedia.Frame">
					<Children>
						
						<!-- Top decorative header bar -->
						<Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="80" HorizontalAlignment="Center" VerticalAlignment="Top" Sprite="StdAssets\tabbar_popup">
							<Children>
								<!-- Category badge (left) -->
								<Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="125" SuggestedHeight="46" MarginLeft="28" MarginTop="18" HorizontalAlignment="Left" Sprite="StdAssets\round_frame" Color="@CategoryColor">
									<Children>
										<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="SPGeneral.MediumText" Brush.FontSize="12" Brush.TextColor="#1A120CFF" Text="@CategoryText" />
									</Children>
								</Widget>
								
								<!-- Event title (center) -->
								<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" MarginTop="4" Brush="SPGeneral.MediumText" Brush.FontSize="34" Brush.TextColor="#EAD7B0FF" Text="@EventTitle" />
								
								<!-- Time/location indicator (right) -->
								<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginRight="28" MarginTop="28" HorizontalAlignment="Right" Brush="SPGeneral.SmallText" Brush.FontSize="11" Brush.TextColor="#CBB894FF" Text="@TimeLocationText" />
							</Children>
						</Widget>

						<!-- Main content area -->
						<Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="560" MarginTop="92" MarginLeft="28" MarginRight="28">
							<Children>
								
								<!-- Left panel: Scene illustration/character -->
								<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="380" HorizontalAlignment="Left">
									<Children>
										<!-- Background panel for image -->
										<BrushWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="Encyclopedia.SubPage.Element">
											<Children>
												<!-- Scene image or character portrait -->
												<ImageWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="450" MarginTop="10" MarginLeft="10" MarginRight="10" Sprite="@SceneImagePath" />
												
												<!-- Note: CharacterTableauWidget removed - causes binding errors during LoadMovie even with IsVisible=false -->
												<!-- Character display will be added in future version when events need character visuals -->
											</Children>
										</BrushWidget>
									</Children>
								</Widget>

								<!-- Right panel: Story text and choices -->
								<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="640" MarginLeft="400" HorizontalAlignment="Left">
									<Children>
										
										<!-- Story text area with scroll -->
										<ScrollablePanel WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="280" MarginTop="10" VerticalAlignment="Top" MouseScrollAxis="Vertical" ClipRect="StoryClipRect" InnerPanel="StoryClipRect\StoryText" AutoHideScrollBars="true">
											<Children>
												<Widget Id="StoryClipRect" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" ClipContents="true">
													<Children>
														<RichTextWidget Id="StoryText" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" MarginLeft="16" MarginRight="26" MarginTop="12" Brush="SPGeneral.MediumText" Brush.FontSize="17" Brush.TextColor="#E7D6B5FF" Brush.LineSpacing="26" Text="@StoryText" />
													</Children>
												</Widget>
											</Children>
										</ScrollablePanel>

										<!-- Choices section -->
										<Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="270" MarginTop="300" VerticalAlignment="Top">
											<Children>
												<!-- "Your Choice" header -->
												<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginTop="6" Brush="SPGeneral.MediumText" Brush.FontSize="13" Brush.TextColor="#BFA77DFF" Text="— Choose Your Action —" />
												
												<!-- Choice buttons list -->
												<ListPanel DataSource="{ChoiceOptions}" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" MarginTop="35" StackLayout.LayoutMethod="VerticalBottomToTop">
													<ItemTemplate>
														<EventChoiceButton />
													</ItemTemplate>
												</ListPanel>
											</Children>
										</Widget>

									</Children>
								</Widget>

							</Children>
						</Widget>

						<!-- Bottom status bar with escalation tracks -->
						<Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="70" VerticalAlignment="Bottom" MarginBottom="10" MarginLeft="30" MarginRight="30">
							<Children>
								<!-- Background panel -->
								<BrushWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="Encyclopedia.SubPage.Element">
									<Children>
										<!-- Escalation track displays -->
										<Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" MarginLeft="15" MarginRight="15" MarginTop="10" MarginBottom="10">
											<Children>
												<!-- Heat track -->
												<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="230" HorizontalAlignment="Left">
													<Children>
														<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="2" Brush="SPGeneral.SmallText" Brush.FontSize="11" Brush.TextColor="#BFA77DFF" Text="Heat" />
														<Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="180" SuggestedHeight="12" MarginTop="20" HorizontalAlignment="Left" Sprite="StdAssets\progressbar_frame">
															<Children>
																<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="@HeatBarWidth" Sprite="StdAssets\progressbar_fill" Color="#FF6644FF" />
															</Children>
														</Widget>
														<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="35" Brush="SPGeneral.SmallText" Brush.FontSize="10" Brush.TextColor="#E7D6B5FF" Text="@HeatText" />
													</Children>
												</Widget>
												
												<!-- Discipline track -->
												<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="230" HorizontalAlignment="Center" PositionXOffset="-100">
													<Children>
														<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="2" Brush="SPGeneral.SmallText" Brush.FontSize="11" Brush.TextColor="#BFA77DFF" Text="Discipline" />
														<Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="180" SuggestedHeight="12" MarginTop="20" HorizontalAlignment="Left" Sprite="StdAssets\progressbar_frame">
															<Children>
																<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="@DisciplineBarWidth" Sprite="StdAssets\progressbar_fill" Color="#4488FFFF" />
															</Children>
														</Widget>
														<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="35" Brush="SPGeneral.SmallText" Brush.FontSize="10" Brush.TextColor="#E7D6B5FF" Text="@DisciplineText" />
													</Children>
												</Widget>
												
												<!-- Lance Rep track -->
												<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="230" HorizontalAlignment="Center" PositionXOffset="100">
													<Children>
														<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="2" Brush="SPGeneral.SmallText" Brush.FontSize="11" Brush.TextColor="#BFA77DFF" Text="Lance Reputation" />
														<Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="180" SuggestedHeight="12" MarginTop="20" HorizontalAlignment="Left" Sprite="StdAssets\progressbar_frame">
															<Children>
																<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="@LanceRepBarWidth" Sprite="StdAssets\progressbar_fill" Color="#44FF88FF" />
															</Children>
														</Widget>
														<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="35" Brush="SPGeneral.SmallText" Brush.FontSize="10" Brush.TextColor="#E7D6B5FF" Text="@LanceRepText" />
													</Children>
												</Widget>
												
												<!-- Fatigue indicator -->
												<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="150" HorizontalAlignment="Right">
													<Children>
														<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="2" Brush="SPGeneral.SmallText" Brush.FontSize="11" Brush.TextColor="#BFA77DFF" Text="Fatigue" />
														<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="20" Brush="SPGeneral.MediumText" Brush.FontSize="18" Brush.TextColor="#E7D6B5FF" Text="@FatigueText" />
													</Children>
												</Widget>
											</Children>
										</Widget>
									</Children>
								</BrushWidget>
							</Children>
						</Widget>

					</Children>
				</BrushWidget>
				
				<!-- Close button (top right) -->
				<ButtonWidget Command.Click="ExecuteClose" HeightSizePolicy="Fixed" WidthSizePolicy="Fixed" SuggestedHeight="50" SuggestedWidth="50" VerticalAlignment="Center" HorizontalAlignment="Center" PositionYOffset="-310" PositionXOffset="500" Brush="Popup.CloseButton" IsVisible="@CanClose" />

			</Children>
		</Widget>
	</Window>
</Prefab>
