<Prefab>
	<Constants>
		<Constant Name="Encyclopedia.Frame.Width" BrushLayer="Default" BrushName="Encyclopedia.Frame" BrushValueType="Width" />
		<Constant Name="Encyclopedia.Frame.Height" BrushLayer="Default" BrushName="Encyclopedia.Frame" BrushValueType="Height" />
	</Constants>
	<Window>
		<!-- Semi-transparent overlay background -->
		<Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Sprite="BlankWhiteSquare_9" Color="#000000CC">
			<Children>

				<!-- Main popup frame -->
				<BrushWidget Id="ProvisionsPopup" DoNotAcceptEvents="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!Encyclopedia.Frame.Width" SuggestedHeight="!Encyclopedia.Frame.Height" HorizontalAlignment="Center" VerticalAlignment="Center" MarginBottom="35" Brush="Encyclopedia.Frame">
					<Children>
						
						<!-- Header bar with title -->
						<Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="720" SuggestedHeight="155" HorizontalAlignment="Center" VerticalAlignment="Top" PositionXOffset="6" PositionYOffset="-18" Sprite="StdAssets\tabbar_popup" IsDisabled="true">
							<Children>
								<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="-25" Brush="Recruitment.Popup.Title.Text" Brush.FontSize="38" IsDisabled="true" Text="@HeaderText" />
							</Children>
						</Widget>

						<!-- Left panel: Info section -->
						<Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="350" SuggestedHeight="700" MarginLeft="30" MarginTop="150" HorizontalAlignment="Left" VerticalAlignment="Top">
							<Children>
								<!-- Ration info text (T1-T6 only) -->
								<RichTextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" MarginTop="20" MarginLeft="10" MarginRight="10" Brush="SPGeneral.SmallText" Brush.FontSize="14" Text="@RationInfoText" IsVisible="@ShowRationInfo"/>
								
								<!-- Restock info -->
								<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginTop="560" Brush="SPGeneral.MediumText" Brush.FontSize="12" Text="@RestockInfoText"/>
								
								<!-- Player gold display -->
								<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginTop="590" Brush="Recruitment.Popup.Title.Text" Brush.FontSize="18" Text="@PlayerGoldText"/>
							</Children>
						</Widget>

						<!-- Right panel: Provisions Grid -->
						<ScrollablePanel WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="800" MarginTop="150" MarginBottom="40" MarginLeft="400" HorizontalAlignment="Left" MouseScrollAxis="Vertical" ClipRect="ListClipRect" InnerPanel="ListClipRect\List" VerticalScrollbar="..\RightSideScrollbar" AutoHideScrollBars="false">
							<Children>
								<Widget Id="ListClipRect" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" ClipContents="true">
									<Children>
										<ListPanel Id="List" DataSource="{ProvisionRows}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" StackLayout.LayoutMethod="VerticalBottomToTop">
											<ItemTemplate>
												<QuartermasterProvisionCardRow ButtonType="Radio" />
											</ItemTemplate>
										</ListPanel>
									</Children>
								</Widget>
							</Children>
						</ScrollablePanel>

						<!-- Scrollbar -->
						<ScrollbarWidget HeightSizePolicy="Fixed" WidthSizePolicy="CoverChildren" Id="RightSideScrollbar" MinValue="0" MaxValue="100" MarginRight="20" MarginTop="150" AlignmentAxis="Vertical" HorizontalAlignment="Right" SuggestedHeight="700" Handle="RightSideScrollbarHandle" UpdateChildrenStates="true">
							<Children>
								<ImageWidget HeightSizePolicy="StretchToParent" WidthSizePolicy="Fixed" SuggestedWidth="2" VerticalAlignment="Center" Brush="Encyclopedia.Scrollbar.Flat.Bed"/>
								<ImageWidget Id="RightSideScrollbarHandle" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="8" SuggestedHeight="50" VerticalAlignment="Top" Brush="Encyclopedia.Scrollbar.Flat.Handle"/>
							</Children>
						</ScrollbarWidget>
						
					</Children>
				</BrushWidget>
				
				<!-- Close button (top right of popup) -->
				<ButtonWidget Command.Click="ExecuteClose" HeightSizePolicy="Fixed" WidthSizePolicy="Fixed" SuggestedHeight="60" SuggestedWidth="60" VerticalAlignment="Center" HorizontalAlignment="Center" PositionYOffset="-410" PositionXOffset="680" Brush="Popup.CloseButton"/>

			</Children>
		</Widget>
	</Window>
</Prefab>

