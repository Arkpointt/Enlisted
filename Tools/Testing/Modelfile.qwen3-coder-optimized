# Optimized Modelfile for QWEN 3 Coder
FROM qwen3-coder:30b

# CRITICAL: Context window - Ollama defaults to 2048 which is too small
PARAMETER num_ctx 32768

# Output tokens - allow long code generation
PARAMETER num_predict 8192

# Temperature for code generation (0.7 recommended for QWEN 3 Coder)
PARAMETER temperature 0.7

# Top-p sampling (0.8-0.9 for code)
PARAMETER top_p 0.9

# Top-k sampling
PARAMETER top_k 20

# Repeat penalty to avoid repetition
PARAMETER repeat_penalty 1.05

# GPU layers - OPTIMIZED FOR RTX 4090 (24GB VRAM)
# Load entire model to GPU for maximum speed
PARAMETER num_gpu 999

# Thread count - OPTIMIZED FOR 32 CPU CORES
# Use 16 threads (half of 32) to avoid CPU saturation
PARAMETER num_thread 16

# System prompt optimized for code generation
SYSTEM You are an expert C# developer working on a Bannerlord mod. Generate clean, well-structured code following the project's coding standards. Always include proper error handling and logging.
