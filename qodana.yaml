#-------------------------------------------------------------------------------#
#               Qodana analysis is configured by qodana.yaml file               #
#             https://www.jetbrains.com/help/qodana/qodana-yaml.html            #
#-------------------------------------------------------------------------------#

#################################################################################
#              WARNING: Do not store sensitive information in this file,        #
#               as its contents will be included in the Qodana report.          #
#################################################################################
version: "1.0"

#Specify IDE code to run analysis without container (Applied in CI/CD pipeline)
ide: QDNET

#Specify inspection profile for code analysis
profile:
  name: qodana.starter

#Enable inspections
#include:
#  - name: <SomeEnabledInspectionId>

#Enable inspections
# Blueprint Standards: "Follow ReSharper recommendations (never suppress without documented reason)"
# Enforce code quality rules from Blueprint
include:
  - name: RedundantUsingDirective  # Blueprint: No unused code
  - name: RedundantNameQualifier  # Blueprint: No redundant namespace qualifiers
  - name: UnusedMember.Local  # Blueprint: Remove unused methods/variables
  - name: UnusedParameter.Local  # Blueprint: No unused code
  - name: ConvertToConstant.Local  # Code quality improvement

#Disable inspections
exclude:
  - name: All
    paths:
      - "**/*.md"  # Disable all inspections for Markdown files
      - "**/Tools/**"  # Development scripts, not production code
      - "**/Debugging/**"  # Debug utilities, not production code
  - name: MarkdownIncorrectTableFormatting
    paths:
      - "**/*.md"  # Explicitly disable table formatting warnings for Markdown
  - name: UnusedMember.Local
    paths:
      - src/Mod.GameAdapters/Patches/**/*.cs  # Harmony patches - methods called dynamically by Harmony runtime
  - name: UnusedAutoPropertyAccessor.Global
    paths:
      - src/Features/Interface/News/Models/CampLifeLedger.cs  # Properties used by GetRollingTotals() return type
      - src/Features/Equipment/UI/QuartermasterProvisionsVM.cs  # Properties used by Gauntlet UI binding
      - src/Features/Combat/Behaviors/EnlistedEncounterBehavior.cs  # Instance singleton pattern
      - src/Features/Combat/Behaviors/EnlistedKillTrackerBehavior.cs  # Instance singleton pattern
      - src/Features/Content/MapIncidentManager.cs  # Instance singleton pattern
      - src/Features/Enlistment/Behaviors/MusterMenuHandler.cs  # Instance singleton pattern
      - src/Features/Equipment/UI/QuartermasterEquipmentSelectorBehavior.cs  # Instance singleton pattern
      - src/Features/Equipment/UI/QuartermasterProvisionsBehavior.cs  # Instance singleton pattern
      - src/Features/Retinue/Core/RetinueLifecycleHandler.cs  # Instance singleton pattern
      - src/Features/Retinue/Systems/RetinueCasualtyTracker.cs  # Instance singleton pattern
      - src/Features/Enlistment/Behaviors/MusterMenuHandler.cs  # RationOutcome.set needed for object initialization
  - name: AssignNullToNotNullAttribute
    paths:
      - src/Features/Interface/News/State/CampNewsState.cs  # False positive - null check exists before Array.Copy
  - name: ConditionIsAlwaysTrueOrFalse
    paths:
      - src/Mod.GameAdapters/Patches/PostDischargeProtectionPatch.cs  # False positive - condition is not always true
  - name: ConstantNullCoalescingCondition
    paths:
      - src/Features/Enlistment/Behaviors/EnlistmentBehavior.cs  # False positives - null coalescing operators are valid
  - name: DefaultStructEqualityIsUsed.Global
    paths:
      - src/Features/Interface/Behaviors/EnlistedNewsBehavior.cs  # DispatchItem implements IEquatable properly
  - name: UsageOfDefaultStructEquality
    paths:
      - src/Features/Interface/Behaviors/EnlistedNewsBehavior.cs  # DispatchItem implements IEquatable properly

#Execute shell command before Qodana execution (Applied in CI/CD pipeline)
#bootstrap: sh ./prepare-qodana.sh

#Install IDE plugins before Qodana execution (Applied in CI/CD pipeline)
#plugins:
#  - id: <plugin.id> #(plugin id can be found at https://plugins.jetbrains.com)

# Quality gate. Will fail the CI/CD pipeline if any condition is not met
# severityThresholds - configures maximum thresholds for different problem severities
# testCoverageThresholds - configures minimum code coverage on a whole project and newly added code
# Code Coverage is available in Ultimate and Ultimate Plus plans
#failureConditions:
#  severityThresholds:
#    any: 15
#    critical: 5
#  testCoverageThresholds:
#    fresh: 70
#    total: 50
